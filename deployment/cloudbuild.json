{
    "steps": [
        {
            "name": "gcr.io/cloud-builders/npm",
            "args": ["install"]
        },
        {
            "name": "gcr.io/cloud-builders/npm",
            "args": ["test"]
        },
        {
            "name": "gcr.io/cloud-builders/docker",
            "entrypoint": "bash",
            "args": ["-c", "[[ \"${_MASTER}\" == \"true\" ]] && docker build -t gcr.io/${PROJECT_ID}/nodeapp:latest -t -t gcr.io/${PROJECT_ID}/nodeapp:${COMMIT_ID}"]
        }
    ],
    "timeout": "240s"
}